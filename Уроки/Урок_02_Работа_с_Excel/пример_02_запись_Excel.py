"""
–ü—Ä–∏–º–µ—Ä 2.2: –ë–∞–∑–æ–≤–∞—è –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ Excel

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Excel —Ñ–∞–π–ª—ã
"""

from openpyxl import Workbook, load_workbook
from openpyxl.styles import Font, Alignment
from pathlib import Path


def –ø—Ä–∏–º–µ—Ä_—Å–æ–∑–¥–∞–Ω–∏—è_–Ω–æ–≤–æ–≥–æ_—Ñ–∞–π–ª–∞():
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ Excel —Ñ–∞–π–ª–∞ –∏ –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö"""
    print("=" * 60)
    print("–ü–†–ò–ú–ï–† 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞")
    print("=" * 60)
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Ä–∞–±–æ—á—É—é –∫–Ω–∏–≥—É
    workbook = Workbook()
    worksheet = workbook.active
    worksheet.title = "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã"
    
    # –°–ø–æ—Å–æ–± 1: –ó–∞–ø–∏—Å—å –ø–æ –∞–¥—Ä–µ—Å—É —è—á–µ–π–∫–∏
    worksheet["A1"] = "–ü–∞—Ä–∞–º–µ—Ç—Ä"
    worksheet["B1"] = "–ó–Ω–∞—á–µ–Ω–∏–µ"
    
    # –°–ø–æ—Å–æ–± 2: –ó–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ cell(row, column)
    worksheet.cell(row=2, column=1, value="–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ")
    worksheet.cell(row=2, column=2, value=220.5)
    worksheet.cell(row=3, column=1, value="–ú–æ—â–Ω–æ—Å—Ç—å")
    worksheet.cell(row=3, column=2, value=1000.0)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö
    –ø–∞—Ä–∞–º–µ—Ç—Ä—ã = [
        ("–†–µ–∂–∏–º", "—É—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏–π—Å—è"),
        ("–í—Ä–µ–º—è", 5.0),
        ("–ò—Ç–µ—Ä–∞—Ü–∏–∏", 10),
    ]
    
    –Ω–∞—á–∞–ª—å–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞ = 4
    for row_idx, (–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–∏–µ) in enumerate(–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, start=–Ω–∞—á–∞–ª—å–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞):
        worksheet.cell(row=row_idx, column=1, value=–∫–ª—é—á)
        worksheet.cell(row=row_idx, column=2, value=–∑–Ω–∞—á–µ–Ω–∏–µ)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª
    –∏–º—è_—Ñ–∞–π–ª–∞ = "—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã_–ø—Ä–∏–º–µ—Ä.xlsx"
    workbook.save(–∏–º—è_—Ñ–∞–π–ª–∞)
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª: {–∏–º—è_—Ñ–∞–π–ª–∞}")
    print(f"   –ó–∞–ø–∏—Å–∞–Ω–æ —Å—Ç—Ä–æ–∫: {worksheet.max_row}")
    print(f"   –ó–∞–ø–∏—Å–∞–Ω–æ —Å—Ç–æ–ª–±—Ü–æ–≤: {worksheet.max_column}")


def –ø—Ä–∏–º–µ—Ä_–∑–∞–ø–∏—Å–∏_—Ç–∞–±–ª–∏—Ü—ã():
    """–ó–∞–ø–∏—Å—å —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö"""
    print("\n" + "=" * 60)
    print("–ü–†–ò–ú–ï–† 2: –ó–∞–ø–∏—Å—å —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö")
    print("=" * 60)
    
    workbook = Workbook()
    worksheet = workbook.active
    worksheet.title = "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã"
    
    # –ó–∞–≥–æ–ª–æ–≤–∫–∏
    –∑–∞–≥–æ–ª–æ–≤–∫–∏ = ["–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä", "P_–∏—Å—Ö, –ú–í—Ç", "P_—É—Å—Ç, –ú–í—Ç", "P_–Ω–µ—É—Å—Ç, –ú–í—Ç"]
    for col_idx, –∑–∞–≥–æ–ª–æ–≤–æ–∫ in enumerate(–∑–∞–≥–æ–ª–æ–≤–∫–∏, start=1):
        cell = worksheet.cell(row=1, column=col_idx, value=–∑–∞–≥–æ–ª–æ–≤–æ–∫)
        cell.font = Font(bold=True)
        cell.alignment = Alignment(horizontal='center')
    
    # –î–∞–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤
    –¥–∞–Ω–Ω—ã–µ_–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ = [
        {"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": "–ì-1", "P_–∏—Å—Ö": 150, "P_—É—Å—Ç": 145, "P_–Ω–µ—É—Å—Ç": None},
        {"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": "–ì-2", "P_–∏—Å—Ö": 200, "P_—É—Å—Ç": None, "P_–Ω–µ—É—Å—Ç": 210},
        {"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": "–ì-3", "P_–∏—Å—Ö": 180, "P_—É—Å—Ç": 175, "P_–Ω–µ—É—Å—Ç": None},
    ]
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    for row_idx, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä in enumerate(–¥–∞–Ω–Ω—ã–µ_–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤, start=2):
        for col_idx, –∑–∞–≥–æ–ª–æ–≤–æ–∫ in enumerate(–∑–∞–≥–æ–ª–æ–≤–∫–∏, start=1):
            –∫–ª—é—á = –∑–∞–≥–æ–ª–æ–≤–æ–∫.split(",")[0]  # –£–±–∏—Ä–∞–µ–º ", –ú–í—Ç"
            –∑–Ω–∞—á–µ–Ω–∏–µ = –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä.get(–∫–ª—é—á, "")
            worksheet.cell(row=row_idx, column=col_idx, value=–∑–Ω–∞—á–µ–Ω–∏–µ)
    
    –∏–º—è_—Ñ–∞–π–ª–∞ = "–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã_–ø—Ä–∏–º–µ—Ä.xlsx"
    workbook.save(–∏–º—è_—Ñ–∞–π–ª–∞)
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª: {–∏–º—è_—Ñ–∞–π–ª–∞}")
    print(f"   –ó–∞–ø–∏—Å–∞–Ω–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤: {len(–¥–∞–Ω–Ω—ã–µ_–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤)}")


def –ø—Ä–∏–º–µ—Ä_–¥–æ–±–∞–≤–ª–µ–Ω–∏—è_–∫_—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É_—Ñ–∞–π–ª—É():
    """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Ñ–∞–π–ª—É"""
    print("\n" + "=" * 60)
    print("–ü–†–ò–ú–ï–† 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Ñ–∞–π–ª—É")
    print("=" * 60)
    
    # –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    –∏–º—è_—Ñ–∞–π–ª–∞ = "—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã_–ø—Ä–∏–º–µ—Ä.xlsx"
    
    if not Path(–∏–º—è_—Ñ–∞–π–ª–∞).exists():
        workbook = Workbook()
        worksheet = workbook.active
        worksheet["A1"] = "–ü–∞—Ä–∞–º–µ—Ç—Ä"
        worksheet["B1"] = "–ó–Ω–∞—á–µ–Ω–∏–µ"
        workbook.save(–∏–º—è_—Ñ–∞–π–ª–∞)
    
    # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
    workbook = load_workbook(–∏–º—è_—Ñ–∞–π–ª–∞)
    worksheet = workbook.active
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
    –ø–æ—Å–ª–µ–¥–Ω—è—è_—Å—Ç—Ä–æ–∫–∞ = worksheet.max_row
    
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    –Ω–æ–≤—ã–µ_–¥–∞–Ω–Ω—ã–µ = [
        ("–ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä 1", 123.45),
        ("–ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä 2", 678.90),
    ]
    
    for row_idx, (–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–∏–µ) in enumerate(–Ω–æ–≤—ã–µ_–¥–∞–Ω–Ω—ã–µ, start=–ø–æ—Å–ª–µ–¥–Ω—è—è_—Å—Ç—Ä–æ–∫–∞ + 1):
        worksheet.cell(row=row_idx, column=1, value=–∫–ª—é—á)
        worksheet.cell(row=row_idx, column=2, value=–∑–Ω–∞—á–µ–Ω–∏–µ)
    
    workbook.save(–∏–º—è_—Ñ–∞–π–ª–∞)
    print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª {–∏–º—è_—Ñ–∞–π–ª–∞}: {len(–Ω–æ–≤—ã–µ_–¥–∞–Ω–Ω—ã–µ)}")
    print(f"   –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ: {worksheet.max_row}")


def –ø—Ä–∏–º–µ—Ä_–∑–∞–ø–∏—Å–∏_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤_—Ä–∞—Å—á–µ—Ç–∞():
    """–ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞ (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä)"""
    print("\n" + "=" * 60)
    print("–ü–†–ò–ú–ï–† 4: –ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞")
    print("=" * 60)
    
    workbook = Workbook()
    
    # –õ–∏—Å—Ç 1: –û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    worksheet1 = workbook.active
    worksheet1.title = "–û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"
    
    –æ–±—â–∏–µ_—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã = {
        "–í–∏–¥ —Ä–∞—Å—á–µ—Ç–∞": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –î–£",
        "–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞": True,
        "–í—Ä–µ–º—è —Ä–∞—Å—á–µ—Ç–∞": "0:05:30",
        "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π": 15,
    }
    
    row = 1
    for –∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–∏–µ in –æ–±—â–∏–µ_—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.items():
        worksheet1.cell(row=row, column=1, value=–∫–ª—é—á)
        worksheet1.cell(row=row, column=2, value=str(–∑–Ω–∞—á–µ–Ω–∏–µ))
        row += 1
    
    # –õ–∏—Å—Ç 2: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤
    worksheet2 = workbook.create_sheet("–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã")
    
    –∑–∞–≥–æ–ª–æ–≤–∫–∏ = ["–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä", "P_–∏—Å—Ö", "P_—É—Å—Ç", "P_–Ω–µ—É—Å—Ç"]
    for col_idx, –∑–∞–≥–æ–ª–æ–≤–æ–∫ in enumerate(–∑–∞–≥–æ–ª–æ–≤–∫–∏, start=1):
        worksheet2.cell(row=1, column=col_idx, value=–∑–∞–≥–æ–ª–æ–≤–æ–∫)
    
    —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã_–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ = [
        ["–ì-1", 150, 145, None],
        ["–ì-2", 200, None, 210],
    ]
    
    for row_idx, –¥–∞–Ω–Ω—ã–µ in enumerate(—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã_–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤, start=2):
        for col_idx, –∑–Ω–∞—á–µ–Ω–∏–µ in enumerate(–¥–∞–Ω–Ω—ã–µ, start=1):
            worksheet2.cell(row=row_idx, column=col_idx, value=–∑–Ω–∞—á–µ–Ω–∏–µ)
    
    –∏–º—è_—Ñ–∞–π–ª–∞ = "—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã_—Ä–∞—Å—á–µ—Ç–∞.xlsx"
    workbook.save(–∏–º—è_—Ñ–∞–π–ª–∞)
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª: {–∏–º—è_—Ñ–∞–π–ª–∞}")
    print(f"   –õ–∏—Å—Ç–æ–≤: {len(workbook.sheetnames)}")
    print(f"   –õ–∏—Å—Ç—ã: {', '.join(workbook.sheetnames)}")


# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤
if __name__ == "__main__":
    –ø—Ä–∏–º–µ—Ä_—Å–æ–∑–¥–∞–Ω–∏—è_–Ω–æ–≤–æ–≥–æ_—Ñ–∞–π–ª–∞()
    –ø—Ä–∏–º–µ—Ä_–∑–∞–ø–∏—Å–∏_—Ç–∞–±–ª–∏—Ü—ã()
    –ø—Ä–∏–º–µ—Ä_–¥–æ–±–∞–≤–ª–µ–Ω–∏—è_–∫_—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É_—Ñ–∞–π–ª—É()
    –ø—Ä–∏–º–µ—Ä_–∑–∞–ø–∏—Å–∏_—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤_—Ä–∞—Å—á–µ—Ç–∞()
    
    print("\n" + "=" * 60)
    print("‚úÖ –í–°–ï –ü–†–ò–ú–ï–†–´ –ó–ê–í–ï–†–®–ï–ù–´")
    print("=" * 60)
    print("\nüí° –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏")
    print("   –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –∏—Ö –≤ Excel –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏")

