"""
Пример 1.3: Работа с функциями
Демонстрирует создание и использование функций
"""

print("=" * 50)
print("ПРОСТЫЕ ФУНКЦИИ")
print("=" * 50)


def рассчитать_мощность(напряжение, ток):
    """
    Рассчитывает мощность по формуле P = U * I
    
    Аргументы:
        напряжение (float): Напряжение в вольтах
        ток (float): Ток в амперах
    
    Возвращает:
        float: Мощность в ваттах
    """
    мощность = напряжение * ток
    return мощность  # return завершает выполнение функции и возвращает значение, но может быть не только в конце. Всё, что написано после return в теле функции, не будет выполнено.


# Использование функции
мощность_1 = рассчитать_мощность(220, 5)
мощность_2 = рассчитать_мощность(230, 4.5)
мощность_3 = рассчитать_мощность(330, 10.)

print(f"Мощность 1 при U=220В, I=5А: {мощность_1} Вт")
print(f"Мощность 2 при U=230В, I=4.5А: {мощность_2} Вт")
print(f"Мощность 3 при U=330 В, I=10 А: {мощность_3} Вт")


def проверить_напряжение(напряжение, мин=200, макс=240):
    """
    Проверяет, находится ли напряжение в допустимых пределах
    
    Аргументы:
        напряжение (float): Проверяемое напряжение
        мин (float): Минимальное допустимое значение (по умолчанию 200)
        макс (float): Максимальное допустимое значение (по умолчанию 240)
    
    Возвращает:
        bool: True если напряжение в норме, False если нет
    """
    if мин <= напряжение <= макс:
        return True
    else:
        return False


print("\nПроверка напряжений:")
напряжения_для_проверки = [190, 220, 230, 250]
for напряжение in напряжения_для_проверки:
    результат = проверить_напряжение(напряжение)
    статус = "ОК" if результат else "Вне нормы"
    print(f"  {напряжение} В: {статус}")

print("\n" + "=" * 50)
print("ФУНКЦИИ С ПАРАМЕТРАМИ ПО УМОЛЧАНИЮ")
print("=" * 50)


def выполнить_расчет(режим="установившийся", точность=0.01, логирование=True):
    """
    Имитация выполнения расчета с параметрами по умолчанию
    
    Аргументы:
        режим (str): Тип режима расчета
        точность (float): Требуемая точность
        логирование (bool): Включить ли логирование
    
    Возвращает:
        dict: Результаты расчета
    """
    результат = {
        "режим": режим,
        "точность": точность,
        "статус": "завершен",
        "время": 45.3
    }
    
    if логирование:
        print(f"  Выполняется расчет: {режим}")
        print(f"  Точность: {точность}")
    
    return результат


# Разные способы вызова функции
результат_1 = выполнить_расчет()  # все параметры по умолчанию
print("\nРезультат 1 (по умолчанию):", результат_1)

# ВАЖНО: Логирование (print) внутри функции выполняется ДО возврата результата
# Поэтому сначала выводится информация из функции, затем результат
print("\n" + "="*50)
print("Вызов функции результат_2:")
результат_2 = выполнить_расчет(режим="переходный", точность=0.001)
print("Результат 2 (переходный режим):", результат_2)

результат_3 = выполнить_расчет(точность=0.1, логирование=False)
print("\nРезультат 3 (без логирования):", результат_3)

print("\n" + "=" * 50)
print("ФУНКЦИИ, РАБОТАЮЩИЕ СО СПИСКАМИ И СЛОВАРЯМИ")
print("=" * 50)


def найти_максимальную_нагрузку(параметры):
    """
    Находит максимальное значение в списке параметров нагрузки
    
    Аргументы:
        параметры (list): Список параметров нагрузки
    
    Возвращает:
        tuple: (максимальное значение, его индекс)
    """
    if not параметры:
        return None, None
    
    максимальное_значение = параметры[0]
    индекс_максимума = 0
    
    for индекс, значение in enumerate(параметры):
        if значение > максимальное_значение:
            максимальное_значение = значение
            индекс_максимума = индекс
    
    return максимальное_значение, индекс_максимума


параметры_тест = [100, 150, 200, 175, 250, 180]
макс, индекс = найти_максимальную_нагрузку(параметры_тест)
print(f"Параметры: {параметры_тест}")
print(f"Максимальное значение: {макс} (индекс {индекс})")


def извлечь_данные_из_протокола(протокол):
    """
    Извлекает ключевые данные из словаря протокола
    
    Аргументы:
        протокол (dict): Словарь с данными протокола
    
    Возвращает:
        dict: Словарь с извлеченными данными
    """
    извлеченные_данные = {}
    
    # Ключи, которые нас интересуют
    интересующие_ключи = ["напряжение", "мощность", "режим", "устойчивость"]
    
    for ключ in интересующие_ключи:
        if ключ in протокол:
            извлеченные_данные[ключ] = протокол[ключ]
    
    return извлеченные_данные


протокол_расчета = {
    "напряжение": 220.5,
    "мощность": 1000.0,
    "режим": "установившийся",
    "устойчивость": True,
    "время": 45.3,
    "дополнительная_информация": "много текста..."
}

данные = извлечь_данные_из_протокола(протокол_расчета)
print(f"\nПротокол: {протокол_расчета}")
print(f"Извлеченные данные: {данные}")

print("\n" + "=" * 50)
print("ВЫЧИСЛЕНИЕ ФАКТОРИАЛА")
print("=" * 50)
print("\nФакториал числа n (обозначается n!) = произведение всех чисел от 1 до n")
print("Например: 5! = 1 × 2 × 3 × 4 × 5 = 120")
print("\n" + "-" * 50)
print("СПОСОБ 1: С использованием цикла (более понятно)")
print("-" * 50)


def вычислить_факториал_циклом(n):
    """
    Вычисляет факториал числа с использованием цикла
    
    Аргументы:
        n (int): Число для вычисления факториала
    
    Возвращает:
        int: Факториал числа n (n!)
    
    Пример:
        5! = 1 × 2 × 3 × 4 × 5 = 120
    """
    if n == 0 or n == 1:
        return 1
    
    результат = 1
    # Умножаем все числа от 1 до n
    for i in range(1, n + 1):
        результат = результат * i
    
    return результат


print(f"\nФакториал 5 (через цикл):")
print(f"  5! = 1 × 2 × 3 × 4 × 5 = {вычислить_факториал_циклом(5)}")

print(f"\nФакториал 7 (через цикл):")
print(f"  7! = 1 × 2 × 3 × 4 × 5 × 6 × 7 = {вычислить_факториал_циклом(7)}")

print("\n" + "-" * 50)
print("СПОСОБ 2: Рекурсивная функция (более компактно)")
print("-" * 50)


def вычислить_факториал(n):
    """
    Вычисляет факториал числа рекурсивно
    
    Аргументы:
        n (int): Число для вычисления факториала
    
    Возвращает:
        int: Факториал числа n
    
    Рекурсия работает так:
        5! = 5 × 4!
        4! = 4 × 3!
        3! = 3 × 2!
        2! = 2 × 1!
        1! = 1
    """
    if n == 0 or n == 1:
        return 1
    else:
        return n * вычислить_факториал(n - 1)


print(f"\nФакториал 5 (рекурсивно): {вычислить_факториал(5)}")
print(f"Факториал 7 (рекурсивно): {вычислить_факториал(7)}")

# Демонстрация пошагового вычисления
print("\n" + "-" * 50)
print("Пошаговое вычисление факториала 5:")
print("-" * 50)
результат = 1
for i in range(1, 6):
    результат = результат * i
    print(f"  Шаг {i}: {результат} = {' × '.join(str(j) for j in range(1, i+1))}")

